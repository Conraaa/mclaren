from django.http import JsonResponse

def getTickets(request):
    if request.method == "GET":
        usuario_dni = request.GET.get('Usuario_DNI')
        tickets = [
            {"Asunto": "Problema de conexion","Estado": "P","Prioridad": "Alta","Categoria": "Mclaren","Usuario_DNI": "101", "Usuario_Nombre": "Estratega", "Mensaje": "Desde hoy temprano estoy experimentando problemas de conexion con el sistema. La conexion es inestable y no puedo acceder correctamente. He intentado varias soluciones sin exito. Agradeceria su ayuda para resolver este inconveniente lo antes posible.", "Respuesta": ["Hemos detectado inestabilidad en el servidor. Reiniciamos algunos servicios y la conexión debería restablecerse. ¿Podría intentar nuevamente y confirmar?", "Aún no funciona. Sigo sin poder acceder. ¿Podrían verificar si es un problema con mi usuario?", "Revisamos su usuario y no encontramos anomalías. Pruebe limpiar la caché o usar otro navegador. Avísenos si persiste el problema.", "Borré la caché y cambié de navegador, pero sigue sin conectarse. ¿Podrían revisar nuevamente?"]},
            {"Asunto": "Imposibilidad de dar de alta carreras","Estado": "P","Prioridad": "Media","Categoria": "Mclaren","Usuario_DNI": "102", "Usuario_Nombre": "Mecanico", "Mensaje": "Estoy teniendo problemas para dar de alta nuevas carreras en el sistema. Al intentarlo, aparece un error y no se completa el registro. He probado diferentes opciones, pero el problema persiste. Agradeceria su ayuda para solucionarlo lo antes posible.", "Respuesta": ["Hubo una caída momentánea en la base de datos. Ya está solucionado, puede intentar nuevamente registrar la carrera.", "Ahora me permite avanzar, pero al confirmar el registro, me arroja un error desconocido.", "Detectamos una restricción en la base de datos que generaba conflictos. Ya lo corregimos, intente nuevamente.", "¡Ahora sí funcionó! Gracias por la rápida respuesta."]},
            {"Asunto": "Problema al cargar nuevas pistas","Estado": "P","Prioridad": "Baja","Categoria": "Mclaren","Usuario_DNI": "103", "Usuario_Nombre": "Aerodinamista", "Mensaje": "Estoy teniendo dificultades al intentar cargar nuevas pistas en el sistema. Cuando intento completar el proceso, no se guarda la informacion y no aparece ningún mensaje de error. Agradeceria su ayuda para solucionar este inconveniente.", "Respuesta": ["Verificamos el sistema y no encontramos fallas. ¿Podría indicarnos si recibe algún mensaje de error al intentar cargar la pista?", "Sí, me aparece un error de permisos, aunque tengo rol de Aerodinamica.", "Hubo un problema con la asignación de permisos. Ya lo corregimos. Intente nuevamente y confirme si ya puede cargar la pista.", "¡Funcionó! Ya puedo cargar pistas sin problemas. Gracias."]},
            {"Asunto": "Imposibilidad de ingresar nuevas estrategias","Estado": "P","Prioridad": "Baja","Categoria": "Mclaren","Usuario_DNI": "101", "Usuario_Nombre": "Estratega", "Mensaje": "Al intentar ingresar nuevas estrategias en el sistema, me encuentro con un error que impide completar la carga. Ya he intentado varias veces, pero el problema persiste. Agradeceria su ayuda para resolverlo.", "Respuesta": ["Nuestro sistema tuvo una actualización reciente que pudo afectar el módulo de estrategias. Estamos revisando la causa.", "¿Tienen un tiempo estimado de solución? Necesito ingresar estrategias urgentes.", "Ya identificamos el problema y estamos desplegando una corrección. En 30 minutos debería estar solucionado.", "Gracias, esperaré. Avísenme cuando pueda intentarlo de nuevo."]},
            {"Asunto": "Error al agregar piezas al sistema","Estado": "P","Prioridad": "Baja","Categoria": "Mclaren","Usuario_DNI": "102", "Usuario_Nombre": "Mecanico", "Mensaje": "Al intentar agregar nuevas piezas al sistema, me aparece un error y no puedo completar el proceso. He intentado seguir los pasos correctamente, pero el problema persiste. Solicito su asistencia para solucionarlo.", "Respuesta": ["Recibimos su reporte. Parece haber un error en la validación de datos al agregar piezas. Lo estamos revisando.", "Gracias, intenté con diferentes datos y sigue sin funcionar.", "Se encontró un error en la base de datos que impedía el registro de piezas. Ya fue corregido, intente nuevamente.", "¡Listo! Ya puedo agregar piezas sin problemas. Aprecio la ayuda."]},
            {"Asunto": "Imposibilidad de contratar empleados","Estado": "P","Prioridad": "Alta","Categoria": "Mclaren","Usuario_DNI": "103", "Usuario_Nombre": "Aerodinamista", "Mensaje": "Estoy experimentando un problema al intentar contratar nuevos empleados a traves del sistema. El proceso no se completa correctamente y no aparece ningun mensaje de error claro. Agradeceria su ayuda para resolver este inconveniente.", "Respuesta": ["Detectamos que el sistema de contratación no está guardando los nuevos registros. Estamos investigando el origen del fallo.", "¿Podría ser un problema con la conexión a la base de datos? Desde esta mañana noté algunos errores en otras funciones.", "Exacto, había una inconsistencia en la sincronización de datos. Ya la corregimos. Pruebe nuevamente.", "¡Ahora sí pude registrar empleados! Muchas gracias."]},
        ]
        if usuario_dni:
            tickets = [ticket for ticket in tickets if ticket["Usuario_DNI"] == usuario_dni]
        return JsonResponse({"tickets": tickets}, safe=False)